---
title: Neue Verweiszählung-Systems in Xamarin.iOS
description: Dieses Dokument beschreibt die erweiterten verweiszählung Xamarin System, das alle Xamarin.iOS-Anwendungen standardmäßig aktiviert.
ms.prod: xamarin
ms.assetid: 0221ED8C-5382-4C1C-B182-6C3F3AA47DB1
ms.technology: xamarin-ios
author: lobrien
ms.author: laobri
ms.date: 11/25/2015
ms.openlocfilehash: 8c7b1a88284156cb5d4261f18d5659ed66dfaf64
ms.sourcegitcommit: 4b402d1c508fa84e4fc3171a6e43b811323948fc
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "61037180"
---
# <a name="new-reference-counting-system-in-xamarinios"></a>Neue Verweiszählung-Systems in Xamarin.iOS

Xamarin.iOS 9.2.1 eingeführt, die verbesserte verweiszählung System für alle Anwendungen standardmäßig. Es kann verwendet werden, um viele Speicherprobleme zu vermeiden, die schwer zu verfolgen und korrigieren Sie in früheren Versionen von Xamarin.iOS.

## <a name="enabling-the-new-reference-counting-system"></a>Aktivieren die neue Verweiszählung-System

Ab Xamarin 9.2.1 zählen System neue Ref aktiviert ist, um **alle** Anwendungen standardmäßig.

Wenn Sie eine vorhandene Anwendung entwickeln, sehen Sie die CSPROJ-Datei, um sicherzustellen, dass alle Vorkommen von `MtouchUseRefCounting` festgelegt `true`, z.B. unter:

```xml
<MtouchUseRefCounting>true</MtouchUseRefCounting>
```

Wenn sie, um festgelegt ist `false` wird Ihre Anwendung nicht die neue Tools verwendet werden.

### <a name="using-older-versions-of-xamarin"></a>Ältere Versionen von Xamarin verwenden

Xamarin.iOS 7.2.1 und Funktionen Sie über eine verbesserte Vorschau auf unser neues verweiszählung-System.

**Klassische-API:**

Um diese neue zählen Referenzsystem zu aktivieren, aktivieren die **verweiszählungserweiterung verwenden** Kontrollkästchen finden Sie in der **erweitert** Ihres Projekts auf der Registerkarte **iOS-Buildoptionen** , wie unten dargestellt: 

[![](newrefcount-images/image1.png "Aktivieren Sie die neue zählen Referenzsystem")](newrefcount-images/image1.png#lightbox)

Beachten Sie, dass diese Optionen in neueren Versionen von Visual Studio für Mac entfernt wurden

 **[Einheitliche API:](~/cross-platform/macios/unified/index.md)**

 Neue verweiszählungserweiterung ist erforderlich, für die Unified API und in der Standardeinstellung aktiviert werden soll. Ältere Versionen Ihrer IDE können keine dieser Wert automatisch aktiviert, und Sie möglicherweise mit einem Häkchen von ihm selbst.

    
> [!IMPORTANT]
> Eine frühere Version dieser Funktion schon seit MonoTouch 5.2 jedoch nur zur **Sgen** als eine experimentelle Vorschau. Diese neue, erweiterte Version steht jetzt auch für die **Boehm** Garbage Collector.


In der Vergangenheit gab es zwei Arten von Objekten, die von Xamarin.iOS verwaltet: solche, die lediglich einen Wrapper für ein systemeigenes Objekt (Peer-Objekte), und diejenigen, die erweitert oder neue Funktionalität (abgeleitete Objekte) - integriert in der Regel durch zusätzliche im Speicher enthaltenen Status beibehalten wurden. Zuvor war es möglich, dass wir ein Peerobjekt, mit dem Status erweitern können (z. B. durch Hinzufügen einer C# -Ereignishandler), aber wir zulassen, dass das Objekt, das nicht referenzierte, und klicken Sie dann die gesammelten finden Sie unter. Dies kann einen Absturz später verursachen (z. B. Wenn Sie die Objective-C-Laufzeit wieder in das verwaltete Objekt aufgerufen wird).

Das neue System aktualisiert automatisch die Objekte auf derselben Ebene in Objekte, die von der Laufzeit verwaltet werden, wenn sie zusätzliche Informationen zu speichern.

Dies löst verschiedene stürzt ab, die in Situationen wie diesen zu aufgetreten ist:

```csharp
class MyTableSource : UITableViewSource {
   public override UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath) {
        var cell = tableView.DequeueReusableCell ("myId");
        if (cell != null)
                return cell;

        cell = new UITableViewCell (UITableViewCellStyle.Default, "myId");
        var txt = new UITextField ();
        txt.TouchDown += delegate { Console.WriteLine ("...."); };
        cell.ContentView.AddSubview (txt);
        return cell;
   }
}
```

Dieser Code würde ohne die Erweiterung der Referenz-Anzahl von Abstürzen, da `cell` entladbaren, wird und daher seine `TouchDown` zu delegieren, die in einen Zeiger zum verbleibende übersetzt.

Die Verweis-Count-Erweiterung wird sichergestellt, das verwaltete Objekt bleibt aktiv, und verhindert, dass die Sammlung, vorausgesetzt das systemeigene Objekt von systemeigenem Code beibehalten wird.

Das neue System auch beseitigt die Notwendigkeit *die meisten* private unterstützungsfelder verwendet Bindungen - der Standardansatz Instanz beibehalten wird. Der verwaltete Linker ist intelligent genug, um alle Mitarbeiter entfernen *nicht benötigte* Felder aus Anwendungen, die mit der neue Verweis zählen Erweiterung.

Dies bedeutet, dass jeder verwaltete Objektinstanzen weniger Arbeitsspeicher als je zuvor nutzen. Es lässt sich auch um ein ähnliches Problem, in dem einige dahinter liegenden Felder Verweise enthalten würde, die nicht mehr von der Objective-C-Laufzeit, macht es schwierig, um Speicherplatz freizugeben erforderlich waren.
